<!DOCTYPE html>
<html lang="en">
<head>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-ES7ET950GC"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-ES7ET950GC');
  </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OUSL Exam Target Calc🎯📊</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    /* --- Base Styles (Mostly Unchanged) --- */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
    }

    html {
        /* Improves font scaling */
        font-size: 16px;
    }

    body {
      background: linear-gradient(135deg, #6EE7B7, #3B82F6);
      min-height: 100vh;
      display: flex;
      align-items: center; /* Center vertically */
      justify-content: center; /* Center horizontally */
      padding: 1rem; /* Reduced padding for smaller screens */
    }

    .container {
      background: white;
      border-radius: 1.5rem; /* 24px */
      padding: 1.5rem; /* Default padding, adjusted in media query */
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 540px; /* Max width for larger screens */
      transition: padding 0.3s ease; /* Smooth transition for padding changes */
    }

    h1 {
      text-align: center;
      font-size: 1.75rem; /* Slightly reduced base size */
      font-weight: 700;
      color: #1f2937;
      margin-bottom: 1.5rem; /* Adjusted margin */
      line-height: 1.3; /* Improve line spacing */
    }

    .input-group input,
    .input-group select {
      width: 100%;
      padding: 0.875rem; /* 14px */
      margin-top: 1rem;
      border-radius: 0.75rem; /* 12px */
      border: 1px solid #cbd5e1;
      font-size: 1rem; /* Ensure readable font size */
      transition: border 0.2s;
      appearance: none;
      background-color: white;
      line-height: 1.5; /* Ensure text isn't cramped */
    }

    /* Custom select arrow */
    .input-group select {
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
      background-position: right 0.75rem center; /* Adjusted position */
      background-repeat: no-repeat;
      background-size: 1.25em 1.25em; /* Slightly smaller arrow */
      padding-right: 2.75rem; /* Ensure space for arrow */
    }

    .input-group input:focus,
    .input-group select:focus {
      border-color: #3b82f6;
      outline: none;
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3); /* Add focus ring */
    }

    button {
      width: 100%;
      margin-top: 1.5rem;
      padding: 0.875rem; /* 14px */
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 0.75rem; /* 12px */
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.3s;
    }

    button:hover {
      background: #2563eb;
    }

    button:active {
        transform: scale(0.98); /* Add slight press effect */
    }

    .results {
      margin-top: 1.5rem; /* Adjusted margin */
      display: none;
      background: #f9fafb;
      padding: 1rem; /* Adjusted padding */
      border-radius: 1rem; /* 16px */
    }

    .results h2 {
      text-align: center;
      font-size: 1.1rem;
      font-weight: 600;
      color: #374151;
      margin-bottom: 1rem; /* Adjusted margin */
    }

    .result-item {
      display: flex;
      justify-content: space-between;
      align-items: center; /* Align items vertically */
      padding: 0.6rem 0; /* Adjusted padding */
      border-bottom: 1px solid #e5e7eb;
      flex-wrap: wrap; /* Allow wrapping on very small screens */
      gap: 0.5rem; /* Add gap between label and value if they wrap */
    }

    .result-item:last-child {
      border-bottom: none;
    }

    .result-label {
      color: #6b7280;
      font-size: 0.9rem; /* Slightly smaller label */
      flex-shrink: 0; /* Prevent label from shrinking too much */
    }

    .result-value {
      color: #111827;
      font-weight: 600;
      font-size: 0.95rem; /* Slightly smaller value */
      text-align: right; /* Align value to the right */
      word-break: break-word; /* Prevent long values from overflowing */
    }

    .error {
      color: #dc2626;
      text-align: center;
      margin-top: 1rem;
      display: none;
      font-weight: 500;
      font-size: 0.9rem; /* Adjust font size */
    }

    .care-message, .disclaimer, .feedback-box {
        margin-top: 1.5rem; /* Consistent margin */
        padding: 1rem;
        border-radius: 0.75rem; /* 12px */
        font-size: 0.9rem; /* Adjusted font size */
        line-height: 1.5; /* Improve readability */
        text-align: center;
    }

    .care-message {
      background: #e0f2fe;
      color: #0369a1;
    }

    .care-message strong {
      color: #059669;
    }

    .disclaimer {
      background: #fff7ed;
      color: #92400e;
      font-size: 0.8rem; /* Smaller font for disclaimer */
    }

    .feedback-box {
      background: #f3f4f6;
      color: #1f2937;
      font-weight: 500;
      display: none; /* Hide initially */
    }

    /* Progress Bar Styles */
    .progress-label {
      font-size: 0.85rem; /* Adjusted font size */
      margin-top: 1rem;
      color: #374151;
      margin-bottom: 0.25rem;
      text-align: center; /* Center label */
    }

    .progress-bar {
      width: 100%;
      background: #e5e7eb;
      border-radius: 0.5rem; /* 8px */
      overflow: hidden;
      height: 1rem; /* 16px */
      margin: 0.5rem auto 1rem; /* Center bar horizontally */
      position: relative;
    }
    .progress-inner {
      height: 100%;
      transition: width 0.5s ease;
      border-radius: 0.5rem; /* Match parent */
    }

    /* Final Output Display Styles */
    #final-output-display {
        margin-top: 1.5rem;
        padding: 1.25rem;
        background-color: #e0f2fe;
        border-radius: 1rem; /* 16px */
        text-align: center;
        display: none; /* Hide initially */
        border: 1px solid #bae6fd;
    }

    #final-output-display .label {
        font-size: 1rem;
        font-weight: 600;
        color: #0369a1;
        margin-bottom: 0.5rem;
    }

    #final-output-value {
        font-size: 2rem; /* Adjusted size */
        font-weight: 700;
        color: #2563eb;
        line-height: 1.1;
        word-break: break-word; /* Prevent overflow */
    }


    /* Floating Button Styles */
    .floating-btn {
      position: fixed;
      bottom: 15px; /* Adjusted position */
      right: 15px; /* Adjusted position */
      padding: 10px 16px; /* Slightly smaller padding */
      background: linear-gradient(135deg, #ffffff, #e0f7fa);
      color: #004d40;
      border: none;
      border-radius: 30px;
      text-decoration: none;
      font-weight: bold;
      font-family: sans-serif;
      font-size: 0.85rem; /* Smaller font size */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      z-index: 1000;
    }

    .floating-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }

    /* --- Responsive Adjustments --- */

    /* Styles for medium screens and up (Tablets, Desktops) */
    @media (min-width: 640px) {
        .container {
            padding: 2.5rem; /* Larger padding on bigger screens */
        }
        h1 {
            font-size: 2rem; /* Larger heading on bigger screens */
        }
        .result-label, .result-value {
            font-size: 1rem; /* Larger result text */
        }
        .care-message, .disclaimer, .feedback-box {
             font-size: 0.95rem;
        }
        .disclaimer {
            font-size: 0.85rem;
        }
        #final-output-value {
            font-size: 2.25rem; /* Larger final output value */
        }
        .floating-btn {
            bottom: 20px;
            right: 20px;
            padding: 12px 20px;
            font-size: 1rem;
        }
    }

    /* Styles for very small screens (adjusting the original breakpoint slightly) */
    @media (max-width: 400px) {
        body {
            padding: 0.75rem; /* Even less padding on very small screens */
        }
        .container {
            padding: 1rem; /* Less padding inside container */
            border-radius: 1rem; /* Slightly smaller radius */
        }
        h1 {
            font-size: 1.5rem; /* Smaller heading */
            margin-bottom: 1rem;
        }
        .input-group input,
        .input-group select,
        button {
            padding: 0.75rem; /* Smaller padding for inputs/button */
            font-size: 0.95rem; /* Slightly smaller font */
        }
        .input-group select {
            padding-right: 2.5rem; /* Adjust padding for arrow */
            background-position: right 0.5rem center;
        }
        .results {
            padding: 0.75rem;
        }
        .result-item {
            padding: 0.5rem 0;
        }
        .result-label {
            font-size: 0.85rem;
        }
        .result-value {
            font-size: 0.9rem;
        }
        #final-output-value {
            font-size: 1.75rem; /* Smaller final output value */
        }
        .care-message, .disclaimer, .feedback-box {
            font-size: 0.85rem;
        }
         .disclaimer {
            font-size: 0.75rem;
        }
        .floating-btn {
            bottom: 10px;
            right: 10px;
            padding: 8px 12px;
            font-size: 0.75rem;
        }
    }

  </style>
</head>
<body>
  <div class="container">
    <h1>OUSL Exam Target Calc🎯📊</h1>
    <div class="input-group">
      <input type="number" id="ocam" placeholder="Enter OCAM marks (≥35)" min="35" max="100" />

      <select id="course-type">
        <option value="standard" selected>Standard Course (Nat Sci / HSS)</option>
        <option value="lee3410">LEE3410: English</option>
        <option value="fnu3200">FNU3200</option>
      </select>

      <select id="target-grade">
        <option value="85">A+ (85-100)</option>
        <option value="70">A (70-84)</option>
        <option value="65">A- (65-69)</option>
        <option value="60">B+ (60-64)</option>
        <option value="55">B (55-59)</option>
        <option value="50">B- (50-54)</option>
        <option value="45">C+ (45-49)</option>
        <option value="40">C (40-44)</option>
        <option value="35">C- (35-39)</option>
        <option value="30">D+ (30-34)</option>
        <option value="20">D (20-29)</option>
        <option value="0">E (0-19)</option>
      </select>
    </div>
    <button onclick="calculate()">Calculate Required Score</button>
    <div class="error" id="error-msg">OCAM must be ≥35!</div>

    <div class="results" id="results">
        <h2>Calculation Results</h2>
        <div class="result-item">
          <span class="result-label">Eligibility Status:</span>
          <span class="result-value" id="eligibility">-</span>
        </div>
        <div class="result-item">
          <span class="result-label">Target Grade:</span>
          <span class="result-value" id="target-grade-display">-</span>
        </div>
        <div class="result-item">
          <span class="result-label">Min. Overall Mark (Z) Needed:</span>
          <span class="result-value" id="target-z-display">-</span>
        </div>
        <div class="result-item">
          <span class="result-label">OCAM Contribution:</span>
          <span class="result-value" id="ocam-contribution">-</span>
        </div>
        <div class="result-item">
          <span class="result-label">Min. Final Exam (Y) Needed:</span>
          <span class="result-value" id="required-score">-</span>
        </div>

        <div style="margin-top: 1.5rem;">
            <div class="progress-label">OCAM Contribution to Final Grade (%)</div>
            <div class="progress-bar"><div class="progress-inner" id="ocam-bar" style="background-color: #3b82f6;"></div></div>
            <div class="progress-label">Required Final Exam Contribution (%)</div>
            <div class="progress-bar"><div class="progress-inner" id="final-bar" style="background-color: #f59e0b;"></div></div>
        </div>
    </div>

    <div id="final-output-display">
      <div class="label">🎯 Minimum Final Exam Marks Needed:</div>
      <div id="final-output-value">-</div>
    </div>

    <div id="feedback" class="feedback-box"></div>

    <div class="care-message">
      💙 Made with love for <strong>OUSL Science Students</strong><br />
      <span>Developed by Abishek R (BSc Undergraduate) </span>
    </div>
    <div class="disclaimer">
      📢 This tool is for informational purposes based on the provided guidelines and does not store any user data. Always consult official OUSL documentation and your faculty for definitive grade requirements and policies. Calculations assume standard rules apply unless 'LEE3410' or 'FNU3200' is selected. Note: Rules for FNU3200 assumed based on standard thresholds.
    </div>
  </div>

  <a href="https://abishekrkumar.github.io/GPACalculator2.0/" target="_blank" class="floating-btn">
    Overall GPA Calc
  </a>

  <script>
    function calculate() {
      // --- Get Inputs ---
      const ocamInput = document.getElementById('ocam');
      const targetGradeSelect = document.getElementById('target-grade');
      const courseTypeSelect = document.getElementById('course-type');

      const ocam = parseFloat(ocamInput.value); // OCAM Score (X)
      const targetValue = parseFloat(targetGradeSelect.value); // Minimum Z% for the target grade
      const courseType = courseTypeSelect.value; // 'standard', 'lee3410', or 'fnu3200'

      // --- Get Display Elements ---
      const errorMsg = document.getElementById('error-msg');
      const resultsDiv = document.getElementById('results');
      const feedbackBox = document.getElementById('feedback');
      const eligibilitySpan = document.getElementById('eligibility');
      const targetGradeSpan = document.getElementById('target-grade-display');
      const targetZSpan = document.getElementById('target-z-display');
      const ocamContributionSpan = document.getElementById('ocam-contribution');
      const requiredScoreSpan = document.getElementById('required-score'); // In results table
      const ocamBar = document.getElementById('ocam-bar');
      const finalBar = document.getElementById('final-bar');
      const finalOutputValue = document.getElementById('final-output-value'); // Highlighted output value
      const finalOutputDisplay = document.getElementById('final-output-display'); // Highlighted output container

      // --- Reset Display ---
      errorMsg.style.display = 'none';
      resultsDiv.style.display = 'none'; // Hide results table initially
      feedbackBox.style.display = 'none';
      feedbackBox.textContent = '';
      finalOutputDisplay.style.display = 'none'; // Hide highlighted output initially

      // --- Input Validation ---
      if (isNaN(ocam) || ocam < 0 || ocam > 100) {
          errorMsg.textContent = 'Please enter a valid OCAM score (0-100).';
          errorMsg.style.display = 'block';
          ocamInput.focus();
          return;
      }

      // --- Eligibility Check ---
      const isEligible = ocam >= 35;
      eligibilitySpan.textContent = isEligible ? '✅ Eligible for Final Exam' : '❌ Not Eligible (OCAM < 35)';
      eligibilitySpan.style.color = isEligible ? '#059669' : '#DC2626';

      // If not eligible, show only eligibility part of the results table and stop
      if (!isEligible) {
          resultsDiv.style.display = 'block';
          // Hide other result items if not eligible
          targetGradeSpan.parentElement.style.display = 'none';
          targetZSpan.parentElement.style.display = 'none';
          ocamContributionSpan.parentElement.style.display = 'none';
          requiredScoreSpan.parentElement.style.display = 'none';
          ocamBar.parentElement.parentElement.style.display = 'none'; // Hide progress bars container
          errorMsg.style.display = 'none'; // Hide the general error if eligibility fails
          finalOutputDisplay.style.display = 'none';
          feedbackBox.style.display = 'none';
          return;
      } else {
          // Ensure all result items are visible within the table if eligible
          targetGradeSpan.parentElement.style.display = 'flex';
          targetZSpan.parentElement.style.display = 'flex';
          ocamContributionSpan.parentElement.style.display = 'flex';
          requiredScoreSpan.parentElement.style.display = 'flex';
          ocamBar.parentElement.parentElement.style.display = 'block'; // Show progress bars container
          errorMsg.style.display = 'none';
      }


      // --- Define Calculation Parameters based on Course Type ---
      let ocamWeight, finalWeight, yThreshold1, yThreshold2, zCap;
      if (courseType === 'lee3410') {
        // LEE3410: 30/70 weights, 35/40 thresholds
        ocamWeight = 0.3; finalWeight = 0.7; yThreshold1 = 35; yThreshold2 = 40; zCap = 40;
      } else if (courseType === 'fnu3200') {
        // FNU3200: 50/50 weights, assume standard 30/40 thresholds and cap
        ocamWeight = 0.5; finalWeight = 0.5; yThreshold1 = 30; yThreshold2 = 40; zCap = 40;
      }
      else {
        // Standard: 40/60 weights, 30/40 thresholds (Default)
        ocamWeight = 0.4; finalWeight = 0.6; yThreshold1 = 30; yThreshold2 = 40; zCap = 40;
      }

      // --- Calculate Required Final Exam Score (Y) ---
      let requiredFinal = -1; // Initialize
      if (targetValue < yThreshold1) {
        // Case 1: Target Z requires Y < yThreshold1 (Z = Y)
        requiredFinal = targetValue;
      } else {
        // Case 2: Target Z requires Y >= yThreshold1
        // Calculate the 'ideal' Y needed if the main formula applied
        let yIdeal = (targetValue - ocamWeight * ocam) / finalWeight;

        // Subcase 2a: Ideal Y is below the first threshold (yThreshold1)
        if (yIdeal < yThreshold1) {
          // Need at least Y = yThreshold1. Check if sufficient.
          // Calculate Z if Y is exactly yThreshold1, considering the cap if applicable
          let zAtYThreshold1;
          if (yThreshold1 < yThreshold2) {
              // If yThreshold1 is below the cap range, apply the cap
              zAtYThreshold1 = Math.min(zCap, ocamWeight * ocam + finalWeight * yThreshold1);
          } else {
              // If yThreshold1 is at or above the cap range start, cap doesn't apply yet based on Y alone
              zAtYThreshold1 = ocamWeight * ocam + finalWeight * yThreshold1;
              // However, the *overall* Z might still be capped at zCap if targetValue itself is low, but this logic is complex.
              // Simplified: Assume standard cap applies if Y is between thresholds.
              // Re-evaluating the logic: The cap (Z<=40 if Y<40) applies based on Y's value.
              // If we need Y=yThreshold1, and yThreshold1 < yThreshold2, then Z is potentially capped.
              zAtYThreshold1 = (yThreshold1 < yThreshold2) ? Math.min(zCap, ocamWeight * ocam + finalWeight * yThreshold1) : (ocamWeight * ocam + finalWeight * yThreshold1);
          }

          // If Z score at yThreshold1 is enough, then yThreshold1 is the minimum required Y.
          // Otherwise, the required Y must be higher (at least yThreshold2, or the original ideal Y if it was already >= yThreshold2).
          requiredFinal = (zAtYThreshold1 >= targetValue) ? yThreshold1 : Math.max(yThreshold2, yIdeal);

        }
        // Subcase 2b: Ideal Y is between the thresholds (yThreshold1 <= yIdeal < yThreshold2)
        else if (yIdeal < yThreshold2) {
            // Ideal Y is in the capped range. Check if the actual Z (capped at zCap) meets the target.
            let zActual = Math.min(zCap, ocamWeight * ocam + finalWeight * yIdeal);
            // If the capped Z is sufficient, the ideal Y is required.
            // If not, we need a higher Y (at least yThreshold2, or the original ideal Y if it was already >= yThreshold2).
            requiredFinal = (zActual >= targetValue) ? yIdeal : Math.max(yThreshold2, yIdeal);
        }
        // Subcase 2c: Ideal Y is above the second threshold (yIdeal >= yThreshold2)
        else {
          // Main formula applies directly, no capping based on Y alone.
          requiredFinal = yIdeal;
        }
      }

      // Round up the required final score
      if (requiredFinal >= 0) {
          requiredFinal = Math.ceil(requiredFinal);
      }

      // --- Determine Final Display and Feedback ---
      let finalDisplay; // For display (string)
      let feedback;
      let isPossible = true;

      if (requiredFinal < 0) {
          finalDisplay = "Error";
          feedback = "Calculation error occurred.";
          isPossible = false;
      } else if (requiredFinal > 100) {
          // Display "> 100" in the results table for clarity
          finalDisplay = "> 100";
          // Show the actual calculated value in the highlighted output
          finalOutputValue.textContent = `> 100 (${requiredFinal})`;
          feedback = `🚫 Sorry, achieving this grade requires a final exam score over 100 (${requiredFinal}). Try aiming for a different grade.`;
          isPossible = false;
      } else {
          // Enforce minimum Y if needed based on target Z rule (only if target Z is >= yThreshold1)
          // This ensures that if you aim for a grade requiring Z>=yThreshold1, your minimum Y is also at least yThreshold1.
          if (targetValue >= yThreshold1 && requiredFinal < yThreshold1) {
              requiredFinal = yThreshold1; // Bump up required Y to the threshold
          }

          finalDisplay = `${requiredFinal}/100`;
          // Provide feedback based on difficulty
          if (requiredFinal > 85) feedback = "🔥 Very Challenging! Requires an exceptional performance.";
          else if (requiredFinal > 70) feedback = "⚠️ Tough target! Aim high and prepare thoroughly!";
          else if (requiredFinal > 55) feedback = "💪 Achievable! Consistent effort will get you there.";
          else if (requiredFinal >= yThreshold1) feedback = `👍 Solid chance! Focus on getting ${requiredFinal} or more.`;
          else feedback = `✅ Great! You only need ${requiredFinal} on the final. Keep it up!`;

          // Update the highlighted output value only if possible
          finalOutputValue.textContent = finalDisplay;
      }

      // --- Update Display Elements ---
      targetGradeSpan.textContent = targetGradeSelect.selectedOptions[0].text.split(' ')[0];
      targetZSpan.textContent = `${targetValue}%`;
      ocamContributionSpan.textContent = `${(ocamWeight * ocam).toFixed(1)} / ${(ocamWeight * 100).toFixed(0)}%`;
      requiredScoreSpan.textContent = finalDisplay; // Update score in results table

      // Update progress bars only if the target is possible
      if (isPossible) {
          let ocamContributionPercent = ocamWeight * ocam;
          let finalContributionNeededPercent = finalWeight * Math.min(requiredFinal, 100); // Use capped value for bar

          // Ensure total doesn't exceed 100% visually for the bars
          let totalContribution = ocamContributionPercent + finalContributionNeededPercent;
          if (totalContribution > 100) {
              // Scale down if needed, maintaining ratio (optional, could just cap)
              let scaleFactor = 100 / totalContribution;
              ocamContributionPercent *= scaleFactor;
              finalContributionNeededPercent *= scaleFactor;
          }

          ocamBar.style.width = `${ocamContributionPercent}%`;
          finalBar.style.width = `${finalContributionNeededPercent}%`;
      } else {
          // Reset bars if not possible
          ocamBar.style.width = '0%';
          finalBar.style.width = '0%';
      }

      // Show relevant sections
      resultsDiv.style.display = 'block';
      // Only show final output and feedback if calculation didn't error out
      if (requiredFinal >= 0) {
          finalOutputDisplay.style.display = 'block';
          feedbackBox.textContent = feedback;
          feedbackBox.style.display = 'block';
      } else {
           finalOutputDisplay.style.display = 'none'; // Hide if error
           feedbackBox.style.display = 'none'; // Hide if error
      }
    }

    // --- Event Listeners ---
    // Calculation is triggered by the button's onclick event

  </script>
</body>
</html>
